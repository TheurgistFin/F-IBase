<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:h="http://java.sun.com/jsf/html" 
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets">
  
  <f:view locale="#{sessionBackingBean.locale}">
    <ui:insert name="metadata"/>
    <h:head>
      <title><ui:insert name="pageTitle"></ui:insert></title>
      <script type="text/javascript">
        var LOCALE = '#{sessionBackingBean.locale.language}';
        var CONTEXTPATH = '#{request.contextPath}';
        var THEMEPATH = '#{request.contextPath}/themes/novus/';
      </script>

      <!-- jQuery -->
 
      <script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.2.js"></script>

      <!-- Menu -->
      
      <h:outputScript name="/scripts/gui/menu.js"></h:outputScript>
      
      <!-- Common Styles -->
      
      <link rel="StyleSheet" type="text/css" href="#{request.contextPath}/themes/novus/css/common.css"/>
      
      <ui:insert name="head"/>
    </h:head>
    
    <h:body styleClass="site-body-wrapper"> 
      
      <div id="messages-container">
        <ui:insert name="messages">
          <h:messages globalOnly="false" errorClass="error" fatalClass="error" warnClass="warning" infoClass="info"/>
        </ui:insert>
      </div>
      
      <div id="siteWrapper">
        <div id="siteLayoutWrapper">
          <!-- Site's Menu bar -->
          <div id="site-menu-bar">
            <div id="site-menu-bar-first-column">
              <div class="site-menu-bar-widget" id="site-menu-bar-widget-index"><a href="#{request.contextPath}/">#{locales['generic.header.menuBarWidgetIndexLabel']}</a></div>
              <div class="site-menu-bar-widget" id="site-menu-bar-widget-forge"><a href="#{request.contextPath}/forge/">#{locales['generic.header.menuBarWidgetForgeLabel']}</a></div>
              <div class="site-menu-bar-widget site-menu-bar-widget-disabled" id="site-menu-bar-widget-illusion"><a href="javascript:void(null);">#{locales['generic.header.menuBarWidgetIllusionLabel']}</a></div>
              <div class="site-menu-bar-widget" id="site-menu-bar-widget-store">
                <h:link outcome="/store/index.jsf" value="#{locales['generic.header.menuBarWidgetStoreLabel']}"/>
              </div>
              <div class="site-menu-bar-widget" id="site-menu-bar-widget-forum"><a href="#{request.contextPath}/forum/">#{locales['generic.header.menuBarWidgetForumLabel']}</a></div>
            </div>
            <div id="site-menu-bar-second-column">
            </div>
            <div id="site-menu-bar-third-column">
              <div class="site-menu-bar-widget site-menu-bar-widget-disabled" id="site-menu-bar-widget-search"><a href="javascript:void(null);">#{locales['generic.header.menuBarWidgetSearchLabel']}</a></div>
        
              <h:panelGroup layout="block" class="site-menu-bar-widget" id="site-menu-bar-widget-account"  rendered="#{sessionBackingBean.loggedIn}">
                <a href="javascript:void(null);">#{locales['generic.header.menuBarWidgetAccountLabel']}</a>
              </h:panelGroup>
              
              <h:panelGroup layout="block" class="site-menu-bar-widget" id="site-menu-bar-widget-login" rendered="#{!sessionBackingBean.loggedIn}">
                <a href="#{request.contextPath}/login/">#{locales['generic.header.menuBarWidgetLoginLabel']}</a>
              </h:panelGroup>
        
              <h:panelGroup layout="block" class="site-menu-bar-widget" id="site-menu-bar-widget-locale">
                <a href="javascript:void(null);">#{sessionBackingBean.locale.language}</a>
              </h:panelGroup>
              
              <div style="display: none" id="site-menu-bar-widget-locale-content" class="site-menu-bar-widget-content">
                <h:form>
                  <span>#{locales['generic.header.menuBarWidgetLocaleSelectText']}</span>
                  
                  <ul>
                    <li>
                      <span>
                        <h:commandLink value="#{locales['generic.header.menuBarWidgetLocaleFinnish']}" action="#{sessionBackingBean.changeLanguage('fi')}" />
                      </span>
                    </li>
                    <li>
                      <span>
                        <h:commandLink value="#{locales['generic.header.menuBarWidgetLocaleEnglish']}" action="#{sessionBackingBean.changeLanguage('en')}" />
                      </span>
                    </li>
                  </ul>
                </h:form>
              </div>
              
              <div style="display: none" id="site-menu-bar-widget-account-content" class="site-menu-bar-widget-content">
                <h:form>
                  <ul>
                    <li>
                      <span>
                        <h:link value="#{locales['generic.header.menuBarWidgetAccountEditProfile']}" outcome="/users/editprofile" />
                      </span>
                    </li>
                    <li>
                      <span>
                        <h:link value="#{locales['generic.header.menuBarWidgetAccountLogout']}" outcome="/auth/logout" />
                      </span>
                    </li>
                  </ul>
                </h:form>
              </div>
              
            </div>
          </div>
    
          <!-- Site's Header -->
          <ui:insert name="siteHeader"></ui:insert>

          <!-- Site's Content -->
          <div id="siteContentWrapper">
            <ui:insert name="content"></ui:insert>
            <div class="clearFloating"></div>
          </div>
    
          <!-- Site's Footer -->
          
          <div id="siteFooterWrapper">
            <div id="siteFooterBackground"></div>
            <a id="siteFooterTwitterIcon" class="siteFooterIconContainer" target="_blank" href="https://twitter.com/forgeillusion"></a>
            <a id="siteFooterFacebookIcon" class="siteFooterIconContainer" target="_blank" href="https://www.facebook.com/pages/Forge-Illusion/82322819727"></a>
            <a id="siteFooterRSSIcon" class="siteFooterIconContainer" target="_blank"></a>
            <a id="siteFooterGoogleCodeIcon" class="siteFooterIconContainer" target="_blank" href="http://code.google.com/p/fni/"></a>
          </div>  
          
          <div id="siteFooterTextWrapper">
            <div class="siteFooterTextContainer"><a href="https://twitter.com/forgeillusion">#{locales['generic.footer.followUsTwitter']}</a></div>
            <div class="siteFooterTextContainer"><a href="https://www.facebook.com/pages/Forge-Illusion/82322819727">#{locales['generic.footer.followUsFacebook']}</a></div>
            <div class="siteFooterTextContainer">#{locales['generic.footer.followUsRSS']}</div>
            <div class="siteFooterTextContainer"><a href="http://code.google.com/p/fni/">#{locales['generic.footer.followUsGoogleCode']}</a></div>
            <div class="siteFooterTextContainer followUsText">#{locales['generic.footer.followUs']}</div>
          </div>  
        
          <ui:fragment rendered="#{!empty(analyticsController.webPropertyId)}">
            <script type="text/javascript">
              var _gaq = _gaq || [];
              _gaq.push(['_setAccount', '#{analyticsController.webPropertyId}']);
              _gaq.push(['_trackPageview']);
            
              (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
              })();
            
            </script>
          </ui:fragment>

        </div>
      </div>
    </h:body>
  </f:view>
  
</html>