<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html" template="/WEB-INF/templates/gamelibrary.xhtml">

  <ui:define name="pageTitle">#{locales['gamelibrary.editPublication.pageTitle']}</ui:define>
  <ui:define name="head">
    <!-- View specific -->
    
    <h:outputScript name="scripts/gui/gamelibrary/editpublication.js"></h:outputScript>
    <link rel="StyleSheet" type="text/css" href="#{request.contextPath}/themes/novus/css/editpublication.css"/>
  </ui:define>
  <ui:define name="content"> 
    <h:panelGroup layout="block" id="gamelibrary-edit-publication" >
      <h:form styleClass="gamelibrary-edit-publication-form">
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.typeLabel']}" />
          <div>
            <h:selectOneMenu>
              <f:selectItem itemLabel="#{locales['gamelibrary.editPublication.typeBook']}"/>
            </h:selectOneMenu>
          </div>
        </div>
        
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.nameLabel']}" />
          <div>
            <h:inputText name="name" value="#{publicationEditBackingBean.publicationName}" styleClass="max-width" required="required" requiredMessage="#{locales['gamelibrary.editPublication.nameRequired']}"/>
          </div>
        </div>
        
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.descriptionLabel']}" />
          <div>
            <h:inputTextarea name="description" value="#{publicationEditBackingBean.publicationDescription}" rows="5" styleClass="max-width" required="required" requiredMessage="#{locales['gamelibrary.editPublication.descriptionRequired']}"/>
          </div>
        </div>
        
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.priceLabel']}" />
          <div>
            <h:inputText name="price" type="number" value="#{publicationEditBackingBean.publicationPrice}" styleClass="max-width" required="required" requiredMessage="#{locales['gamelibrary.editPublication.priceRequired']}"/>
          </div>
        </div>
            
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.pdfLabel']}" />
          <div>
            <input type="file" name="file"/>
          </div>
        </div>
        
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.tagsLabel']}" />
          <div>
            <h:selectOneMenu id="tag-select">
              <f:selectItems value="#{publicationEditBackingBean.tagSelectItems}" />
            </h:selectOneMenu>
            
            <div class="new-tag-container">        
              <label>#{locales['gamelibrary.editPublication.newTagLabel']}</label> 
              <div class="max-width">
                <input type="text" value="" name="new-tag"/>
                <a class="add-new-tag" href="javascript:void(null);">#{locales['gamelibrary.editPublication.addTag']}</a>
              </div>
            </div>
            
          </div>
          <div class="tags">
            <h:inputHidden id="tags" value="#{publicationEditBackingBean.publicationTags}" />
          </div>
        </div>
        
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.licenseLabel']}" />
          <div>
            <h:selectOneMenu value="#{publicationEditBackingBean.licenseType}" id="license-select" requiredMessage="#{locales['gamelibrary.editPublication.licenseRequired']}">
              <f:selectItems value="#{publicationEditBackingBean.licenseSelectItems}"></f:selectItems>
            </h:selectOneMenu>
            <div class="license-cc-container">
              <h:outputLabel value="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowModifications']}" />
              <h:selectOneRadio value="#{publicationEditBackingBean.creativeCommonsDerivatives}">
                <f:selectItem itemLabel="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowModificationsYes']}" itemValue="YES"/>
                <f:selectItem itemLabel="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowModificationsNo']}" itemValue="NO"/>
                <f:selectItem itemLabel="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowModificationsShare']}" itemValue="SHARE_ALIKE"/>
              </h:selectOneRadio>
              
              <h:outputLabel value="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowCommercial']}" />
              <h:selectOneRadio value="#{publicationEditBackingBean.creativeCommonsCommercial}">
                <f:selectItem itemLabel="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowCommercialYes']}" itemValue="YES"/>
                <f:selectItem itemLabel="#{locales['gamelibrary.editPublication.licenseCreativeCommonsAllowCommercialNo']}" itemValue="NO"/>
              </h:selectOneRadio>
            </div>
    
            <div class="license-other" >
              <h:outputLabel value="#{locales['gamelibrary.editPublication.linkToLicense']}" />
              <h:inputText value="#{publicationEditBackingBean.licenseOther}" styleClass="max-width"/>
            </div>
          </div>
        </div>
    
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.authorsLabel']}" />
          <h:selectOneMenu id="author-select" styleClass="max-width">
            <f:selectItems value="#{publicationEditBackingBean.authorSelectItems}"/>
          </h:selectOneMenu>
          <h:inputHidden id="author-ids" value="#{publicationEditBackingBean.authorIds}" />
          <div class="authors-container">
            <ui:repeat var="author" value="#{publicationEditBackingBean.authors}">
              <span class="author" data-author-id="#{author.id}">
                <span>#{author.fullName}</span>
                <a class="remove-author" href="javascript:void(null);"></a>
              </span>
            </ui:repeat>
          </div>
        </div>
    
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.settingsLabel']}" />
          <div>
            <h:selectBooleanCheckbox name="requires-delivery" value="#{publicationEditBackingBean.publicationRequiresDelivery}"/>
            <h:outputLabel value="#{locales['gamelibrary.editPublication.requiredDeliveryLabel']}" />
          </div>
          <div>
            <h:selectBooleanCheckbox name="purchasable" value="#{publicationEditBackingBean.publicationPurchasable}"/>
            <h:outputLabel value="#{locales['gamelibrary.editPublication.purchasableLabel']}" />
          </div>
        </div>
    
        <div class="section">
          <h:outputLabel value="#{locales['gamelibrary.editPublication.detailsLabel']}" />
          <table class="details-table">
            <tr>
              <td><h:outputLabel value="#{locales['gamelibrary.editPublication.widthLabel']}" /></td><td><h:inputText name="width" value="#{publicationEditBackingBean.publicationWidth}"/><span>mm</span></td>
            </tr>
            <tr>
              <td><h:outputLabel value="#{locales['gamelibrary.editPublication.heightLabel']}" /></td><td><h:inputText name="height" value="#{publicationEditBackingBean.publicationHeight}"/><span>mm</span></td>
            </tr>
            <tr>
              <td><h:outputLabel value="#{locales['gamelibrary.editPublication.depthLabel']}" /></td><td><h:inputText name="depth" value="#{publicationEditBackingBean.publicationDepth}"/><span>mm</span></td>
            </tr>
            <tr>
              <td><h:outputLabel value="#{locales['gamelibrary.editPublication.weightLabel']}" /></td><td><h:inputText name="weight" value="#{publicationEditBackingBean.publicationWeight}"/><span>g</span></td>
            </tr>
          </table>
        </div>
    
        <h4>#{locales['gamelibrary.editPublication.bookOptionsLabel']}</h4>
        <div class="section">
          <table class="book-options-table">
            <tr>
              <td>
                <h:outputLabel value="#{locales['gamelibrary.editPublication.downloadableLabel']}" />
              </td>
              <td>
                <h:selectBooleanCheckbox name="downloadable" value="#{publicationEditBackingBean.publicationDownloadable}"/>
              </td>
            </tr>
            <tr>
              <td><h:outputLabel value="#{locales['gamelibrary.editPublication.numberOfPagesLabel']}" /></td><td><h:inputText name="numberOfPages" value="#{publicationEditBackingBean.bookNumberOfPages}"/></td>
            </tr>
          </table>
        </div>
        
        <h:commandButton id="submit-button" action="#{publicationEditBackingBean.save}" value="#{locales['gamelibrary.editPublication.saveButtonLabel']}">
          <f:ajax execute="@form" onevent="onJsfPublicationUpdate"/>
        </h:commandButton>
      </h:form>
      
      <h:panelGroup layout="block" id="edit-publication-file-form" style="display: none">
        <form method="post" enctype="multipart/form-data" action="#{request.contextPath}/gamelibrary/publicationFiles/#{publicationEditBackingBean.publicationId}"></form>
      </h:panelGroup>
    </h:panelGroup>
  </ui:define>
</ui:composition>