<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
  xmlns:ui="http://java.sun.com/jsf/facelets" 
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html">
  
  <div class="forge-material" data-material-id="#{material.id}"> 
    <h:panelGroup layout="block" styleClass="forge-material-icon"> 
      <h:graphicImage library="novus" name="/gfx/icons/48x48/forge/icon-#{forgeMaterialsBackingBean.getMaterialIcon(material.type)}.png"/> 
    </h:panelGroup>

    <h:panelGroup layout="block" styleClass="forge-material-info">
      <h:panelGroup layout="block" styleClass="forge-material-title-container">
        <h:outputLink styleClass="forge-material-title" value="#{request.contextPath}/forge/#{forgeMaterialsBackingBean.getMaterialViewer(material)}/#{material.path}" title="#{material.title}">
          <h:outputText value="#{material.title.length() gt 30 ? material.title.substring(0, 27).concat('...') : material.title}"/>
        </h:outputLink>
        
        <h:commandLink action="#{forgeMaterialsBackingBean.starMaterial(material.id)}" styleClass="forge-material-star" style="#{!forgeMaterialsBackingBean.isStarred(material.id) ? '' : 'display: none'}"/>
        <h:commandLink action="#{forgeMaterialsBackingBean.unstarMaterial(material.id)}" styleClass="forge-material-star forge-material-starred" rendered="#{forgeMaterialsBackingBean.isStarred(material.id)}" style="#{forgeMaterialsBackingBean.isStarred(material.id) ? '' : 'display: none'}"/>
      </h:panelGroup>
      
      <h:panelGroup layout="block" styleClass="forge-material-date-container">
        <h:panelGroup styleClass="forge-material-date">
          <h:outputFormat value="#{material.modified}">
            <f:convertDateTime type="date"/>
          </h:outputFormat>
        </h:panelGroup>
      </h:panelGroup>
      
      <h:panelGroup layout="block" styleClass="forge-material-creator-container">
        <h:outputLink styleClass="forge-material-creator" value="#{request.contextPath}/profile/#{material.creator.id}">
          #{material.creator.fullName}
        </h:outputLink>
      </h:panelGroup>
    </h:panelGroup>
    
    <h:panelGroup layout="block" styleClass="forge-material-actions">
      <h:panelGroup layout="block" styleClass="forge-material-action-edit" rendered="#{forgeMaterialsBackingBean.getMaterialEditable(material)}">
        <h:outputLink value="#{request.contextPath}/forge/#{forgeMaterialsBackingBean.getMaterialViewer(material)}/#{material.path}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-edit.png"/> 
          <h:outputLabel value="#{locales['forge.index.materialEditLink']}" />
        </h:outputLink>
      </h:panelGroup>
      
      <h:panelGroup layout="block" styleClass="forge-material-action-view" rendered="#{!forgeMaterialsBackingBean.getMaterialEditable(material)}">
        <h:outputLink value="#{request.contextPath}/forge/#{forgeMaterialsBackingBean.getMaterialViewer(material)}/#{material.path}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-view.png"/> 
          <h:outputLabel value="#{locales['forge.index.materialViewLink']}" />
        </h:outputLink>
      </h:panelGroup>
      
      <h:panelGroup layout="block" styleClass="forge-material-action-download" rendered="#{forgeMaterialsBackingBean.getMaterialDownloadable(material)}">
        <h:outputLink value="#{request.contextPath}/materials/#{material.path}?download=true">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-download.png"/> 
          <h:outputLabel value="#{locales['forge.index.materialDownloadLink']}" />
        </h:outputLink>
      </h:panelGroup>

      <h:panelGroup layout="block" styleClass="forge-material-action-delete" rendered="#{forgeMaterialsBackingBean.getMaterialDeletable(material)}">
        <a href="javascript:void(null)" data-material-id="#{material.id}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-delete.png"/>
          <h:outputLabel value="#{locales['forge.index.materialDeleteLink']}" />
        </a>
      </h:panelGroup>

      <h:panelGroup layout="block" styleClass="forge-material-action-print-pdf" rendered="#{forgeMaterialsBackingBean.getMaterialPrintableAsPdf(material)}">
        <a href="javascript:void(null)" data-material-id="#{material.id}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-print-pdf.png"/>
          <h:outputLabel value="#{locales['forge.index.materialPrintPdfLink']}" />
        </a>
      </h:panelGroup>

      <h:panelGroup layout="block" styleClass="forge-material-action-move" rendered="#{forgeMaterialsBackingBean.getMaterialMovable(material)}">
        <a href="javascript:void(null)" data-material-id="#{material.id}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-move.png"/>
          <h:outputLabel value="#{locales['forge.index.materialMoveLink']}" />
        </a>
      </h:panelGroup>

      <h:panelGroup layout="block" styleClass="forge-material-action-share" rendered="#{forgeMaterialsBackingBean.getMaterialShareable(material)}">
        <a href="javascript:void(null)" data-material-id="#{material.id}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-share.png"/>
          <h:outputLabel value="#{locales['forge.index.materialShareLink']}" />
        </a>
      </h:panelGroup>

      <h:panelGroup layout="block" styleClass="forge-material-action-copy" rendered="#{forgeMaterialsBackingBean.getMaterialCopyable(material)}">
        <a href="javascript:void(null)" data-material-id="#{material.id}" data-allowed-targets="#{forgeMaterialsBackingBean.getMaterialCopyTargets(material.type)}">
          <h:graphicImage library="novus" name="/gfx/icons/16x16/forge/material-action-copy.png"/>
          <h:outputLabel value="#{locales['forge.index.materialCopyLink']}" />
        </a>
      </h:panelGroup>
    </h:panelGroup>
    
  </div>
  
</ui:composition>